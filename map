<style>
    @media (max-width: 468px) {
        .locate_store{
            position:relative;
            left: initial;
            top: initial;
        }
        #map {
            height: 200px!important;
        }
    }
    .map_tooltip {
        background-color: rgba(0,0,0,0.75)!important;
        color:#fff!important;
        /*width:300px;*/
        padding:10px;        
    }
</style>



<script type="text/javascript" src="//codecloud.cdn.speedyrails.net/sites/592482696e6f6450ebc40000/text/javascript/1495734613000/raphael.js"></script>
<script type="text/javascript" src="//codecloud.cdn.speedyrails.net/sites/592482696e6f6450ebc40000/text/javascript/1495734619000/jquery.mousewheel.js"></script>
<script type="text/javascript" src="//mallmaverick.cdn.speedyrails.net/system/site_images/photos/000/005/107/original/mallmaverick_svgmap.js?1412885524"></script>
<div class="content_container main_container position_relative text_center">
    <a href="#" class="locate_store">Locate store <i class="fa fa-search"></i></a>
    <div class="stores_table">
        <ul id="store_list_container_map">
            <script id="store_list_template_map" type="x-tmpl-mustache/text">
                <li><a href="#" store_id="store_{{id}}" onclick="return show_pin(this)" svgmap_region="{{svgmap_region}}">{{name}}</a><li>
            </script>
        </ul>
    </div>
    <div class="map_container">
        <div id="map">
            <!--<img alt="map" id="map_image" src="">-->
        </div>
    </div>
</div>

<script>
    $(document).ready(function(e){
        init(e);
       
        function renderAll (){
            var categories = getStoreCategories();
            var stores = getStoresList(); 
            renderStoreList('#store_list_container_map','#store_list_template_map', stores, "A", "Z");
            reg = {};
    		$.each( stores , function( key, val ) {
                if(val.svgmap_region != null && typeof(val.svgmap_region)  != 'undefined'){
                    obj = {};
                    obj["tooltip"] = "<label class='store_name_map'> "+val.name +"</label>"
                    obj["attr"] = {}
                    obj["attr"]["href"] = '/stores/'+val.slug 
                    reg[val.svgmap_region] = obj
                }
            });
            console.log("stores", stores);
            init_map(reg);
            show_content();
            
    //         $("#map_image").attr("src", getPNGMapURL());
    //         $('#map2').craftmap({
    // 			image: {
    // 				width: 850,
    // 				height: 850,
    // 			},
    // 			map: {
    // 				position: 'center'
    // 			}
    // 		});
        }
        
		loadMallDataCached(renderAll); 
    })
</script>